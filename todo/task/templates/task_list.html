{% extends "base.html" %} {% block content %}

<div class="mt-4">
  <!-- Modal -->
  <div
    class="modal fade"
    id="newTaskModal"
    tabindex="-1"
    aria-labelledby="newTaskModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="newTaskModalLabel">New Task</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <form action="" method="post" class="form" role="form">
            {{ form.csrf_token()}}
            <fieldset class="form-group">
              <legend class="border-bottom mb-4">Sign In</legend>
              <div class="form-group mt-2 mb-2">
                {{ form.title.label(class="form-control-label") }} {% if
                form.title.errors %} {{ form.title(class="form-control
                form-control-lg is-invalid") }}
                <div class="invalid-feedback">
                  {% for error in form.title.errors %}
                  <span>{{ error }}</span>
                  {% endfor %}
                </div>
                {% else %} {{ form.title(class="form-control form-control-lg")
                }} {% endif %}
              </div>
              <div class="form-group mt-2 mb-2">
                {{ form.description.label(class="form-control-label") }} {% if
                form.description.errors %} {{
                form.description(class="form-control form-control-lg
                is-invalid", type="description") }}
                <div class="invalid-feedback">
                  {% for error in form.description.errors %}
                  <span>{{ error }}</span>
                  {% endfor %}
                </div>
                {% else %} {{ form.description(class="form-control
                form-control-lg", type="description") }} {% endif %}
              </div>
            </fieldset>
            <div class="form-group d-grid w-100">
              {{ form.submit(class="btn btn-block btn-danger") }}
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-between">
    <h1>Tasks {{incomplete_tasks|length}}</h1>
    <!-- Button trigger modal -->
    <button
      type="button"
      class="btn btn-danger"
      data-bs-toggle="modal"
      data-bs-target="#newTaskModal"
    >
      New Task
    </button>
  </div>
  <hr />

  {% if incomplete_tasks %} {% for task in incomplete_tasks %}
  {{show_task(task)}} {% endfor %} {% else %}
  <div class="d-flex justify-content-center">
    <h3>Good job! You are done all of your tasks.</h3>
  </div>
  {% endif %}
</div>

{% endblock %} {% macro show_task(task) %}
<div class="card w-100 mt-2 mb-2 pt-2 pb-2">
  <div class="card-body">
    <div class="d-flex justify-content-between">
      <h3 class="card-title">{{task.title}}</h3>
      <a
        href="{{url_for('task.complete_task', task_id=task.task_id)}}"
        class="card-link btn btn-block btn-danger"
        >Done!</a
      >
    </div>
    <h6 class="card-subtitle mb-2 text-muted">
      {% if task.due %} {{task.due.strftime("%Y-%m-%d")}} {% endif %}
    </h6>
    <hr />
    <p class="card-text">{{task.description}}</p>
  </div>
</div>
{% endmacro %}
